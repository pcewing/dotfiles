# i3 config file (v4)
#
# Please see http://i3wm.org/docs/userguide.html for a complete reference!

# Start the compositor (Without fading because it's annoying and slow)
exec_always compton --no-fading-openclose

# use windows key as i3 modifier
set $mod Mod4

# use Ubuntu Mono font in i3bar
font pango:Ubuntu Mono derivative Powerline 10

# use Mouse+$mod to drag floating windows to their wanted position
floating_modifier $mod

# change border settings for all windows; this is necessary to use gaps
for_window [class="^.*"] border pixel 2

# gaps
gaps inner 20

# configure color settings for the focused window
client.focused          #2e9ef4 #002b36 #839496 #00388e   #00ffff

# by default, float feh windows
for_window [class="^feh$"] floating enable

# start a terminal
bindsym $mod+Return exec i3-sensible-terminal

# kill focused window
bindsym $mod+q kill

# launch rofi
bindsym $mod+space exec "rofi -show run"

# change focus
bindsym $mod+h focus left
bindsym $mod+j focus down
bindsym $mod+k focus up
bindsym $mod+l focus right

# alternatively, you can use the cursor keys:
bindsym $mod+Left focus left
bindsym $mod+Down focus down
bindsym $mod+Up focus up
bindsym $mod+Right focus right

# move focused window
bindsym $mod+Shift+h move left
bindsym $mod+Shift+j move down
bindsym $mod+Shift+k move up
bindsym $mod+Shift+l move right

# move workspace
bindsym $mod+Ctrl+h move workspace to output left
bindsym $mod+Ctrl+l move workspace to output right

# alternatively, you can use the cursor keys:
bindsym $mod+Shift+Left move left
bindsym $mod+Shift+Down move down
bindsym $mod+Shift+Up move up
bindsym $mod+Shift+Right move right

# split in horizontal orientation
bindsym $mod+Shift+backslash split h

# split in vertical orientation
bindsym $mod+minus split v
bindsym $mod+t split toggle

# enter fullscreen mode for the focused container
bindsym $mod+f fullscreen toggle

# change container layout (stacked, tabbed, toggle split)
bindsym $mod+s layout stacking
bindsym $mod+w layout tabbed
bindsym $mod+e layout toggle split

# toggle tiling / floating
bindsym $mod+Shift+space floating toggle

# change focus between tiling / floating windows
bindsym $mod+d focus mode_toggle

bindsym $mod+Tab focus parent
bindsym $mod+Shift+Tab focus child

# switch to workspace
bindsym $mod+n workspace 1
bindsym $mod+m workspace 2
bindsym $mod+comma workspace 3
bindsym $mod+period workspace 4
bindsym $mod+slash workspace 5
bindsym $mod+y workspace 6
bindsym $mod+u workspace 7
bindsym $mod+i workspace 8
bindsym $mod+o workspace 9
bindsym $mod+p workspace 10

# move focused container to workspace
bindsym $mod+Shift+n move container to workspace 1
bindsym $mod+Shift+m move container to workspace 2
bindsym $mod+Shift+comma move container to workspace 3
bindsym $mod+Shift+period move container to workspace 4
bindsym $mod+Shift+slash move container to workspace 5
bindsym $mod+Shift+y move container to workspace 6
bindsym $mod+Shift+u move container to workspace 7
bindsym $mod+Shift+i move container to workspace 8
bindsym $mod+Shift+o move container to workspace 9
bindsym $mod+Shift+p move container to workspace 10


# reload the configuration file
bindsym $mod+Shift+c reload

# restart i3 inplace (preserves your layout/session, can be used to upgrade i3)
bindsym $mod+Shift+r restart

# the exit mode is a better way to implement confirmation before terminating
# the X session
bindsym $mod+x mode "exit"
mode "exit" {
    bindsym y exec "i3-msg exit"

    # back to normal: Enter or Escape
    bindsym n mode "default";
    bindsym Return mode "default";
    bindsym Escape mode "default";
}

# resize window (you can also use the mouse for that)
bindsym $mod+r mode "resize"
mode "resize" {
    # These bindings trigger as soon as you enter the resize mode

    # Pressing left will shrink the window’s width.
    # Pressing right will grow the window’s width.
    # Pressing up will shrink the window’s height.
    # Pressing down will grow the window’s height.
    bindsym h resize shrink width 10 px or 10 ppt
    bindsym j resize grow height 10 px or 10 ppt
    bindsym k resize shrink height 10 px or 10 ppt
    bindsym l resize grow width 10 px or 10 ppt

    # same bindings, but for the arrow keys
    bindsym Left resize shrink width 10 px or 10 ppt
    bindsym Down resize grow height 10 px or 10 ppt
    bindsym Up resize shrink height 10 px or 10 ppt
    bindsym Right resize grow width 10 px or 10 ppt

    # back to normal: Enter or Escape
    bindsym Return mode "default"
    bindsym Escape mode "default"
}

# this mode provides a quicker way to execute my most used applications
bindsym $mod+a exec "app_cheatsheet"; mode "apps"
mode "apps" {
    # These bindings trigger as soon as you enter the apps mode
    bindsym p exec "shotwell"; exec "app_cheatsheet -k"; mode "default"
    bindsym s exec "steam"; exec "app_cheatsheet -k"; mode "default"
    bindsym d exec "discord"; exec "app_cheatsheet -k"; mode "default"
    bindsym c exec "chromium-browser"; exec "app_cheatsheet -k"; mode "default"

    # back to normal: Enter or Escape
    bindsym Return mode "default"; exec "app_cheatsheet -k"
    bindsym Escape mode "default"; exec "app_cheatsheet -k"
}

# these bindings will display useful cheatsheets
bindsym $mod+c mode "cheatsheets"
mode "cheatsheets" {
    bindsym l exec "feh --scale-down $HOME/Dropbox/Pictures/CheatSheets/LinuxCheatSheet.png"; mode "default"
    bindsym e exec "feh --scale-down $HOME/Dropbox/Pictures/CheatSheets/EmacsCheatSheet.png"; mode "default"
    bindsym v exec "feh --scale-down $HOME/Dropbox/Pictures/CheatSheets/VimCheatSheet.png"; mode "default"
    bindsym r exec "feh --scale-down $HOME/Dropbox/Pictures/CheatSheets/RegexCheatSheet.png"; mode "default"
    bindsym f exec "feh --scale-down $HOME/Dropbox/Pictures/CheatSheets/LinuxFileSystemCheatSheet.png"; mode "default"

    # back to normal: Enter or Escape
    bindsym Return mode "default"
    bindsym Escape mode "default"
}

# print screen bindings
bindsym --release Print exec "scrot -m $HOME/Pictures/screenshots/%s_%H%M_%d.%m.%Y_$wx$h.png"
bindsym --release Shift+Print exec "scrot -s $HOME/Pictures/screenshots/%s_%H%M_%d%m%Y_$wx$h.png"
bindsym --release $mod+Shift+Print exec "scrot -u -d 4 $HOME/Pictures/screenshots/%s_%H%M_%d%m%Y_$wx$h.png"

# i3bar config
bar {
    colors {
        background #002b36
        statusline #ffffff
        separator #666666

        # <colorclass> <border> <background> <text>
        focused_workspace   #073642 #073642 #fdf6e3
        active_workspace    #073642 #002b36 #839496
        inactive_workspace  #073642 #002b36 #839496
        urgent_workspace    #2f343a #900000 #ffffff
        binding_mode        #2f343a #900000 #ffffff
    }

    status_command py3status -c ~/.config/i3status/i3status.conf
    tray_output primary
    separator_symbol "•"
}

# source the machine-specific screen layout if it exists
exec_always "[ -e ~/.screenlayout/config.sh ] && ~/.screenlayout/config.sh"

# this script will execute the wallpaper rotator if it's not already running
exec_always "sh $HOME/.dotfiles/tools/wpr.sh"

